<!--
  KnowsNav â€” Integrated EyeWrite + SnazyCam Interface

  This page composes the entire KnowsNav application by combining the
  unmodified EyeWrite UI with the SnazyCam noseâ€‘tracking module. The
  EyeWrite code lives under `eyewrite/` and SnazyCam lives under
  `snazycam/`. Neither codebase is altered; integration happens via
  scripts loaded here and in driver.js.

  Key layout features:
    â€¢ EyeWrite remains the primary interface, providing the writing
      canvas, onâ€‘screen keyboard, dwell ring, voice controls, etc.
    â€¢ SnazyCamâ€™s webcam feed and overlay (video + canvas) are
      contained within #snazycam-container. They are hidden by default
      and shown when the user toggles the SnazyCam Controls button.
    â€¢ TensorFlow and BlazeFace scripts are loaded here to support
      SnazyCamâ€™s nose tracking.
    â€¢ The driver script dispatches synthetic mouse movements based on
      SnazyCamâ€™s smoothedCursor and synchronizes dwell times between
      the two modules.

  NOTE: When adding new scripts or styles, place them after the
  EyeWrite and SnazyCam files to avoid overwriting original behavior.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KnowsNav â€“ EyeWrite with SnazyCam Integration</title>
  <!-- EyeWrite stylesheet (unmodified) -->
  <link rel="stylesheet" href="eyewrite/style.css">
  <style>
    /* Container for SnazyCam video and canvas; hidden by default */
    #snazycam-container {
      position: fixed;
      inset: 0;
      z-index: 50;
      /* Start hidden; driver.js toggles display */
      display: none;
    }
    #snazycam-container video,
    #snazycam-container canvas {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    /* Overlay button for toggling SnazyCam */
    #snazycam-toggle-btn {
      position: fixed;
      top: 10px;
      right: 10px;
      padding: 8px 14px;
      border: none;
      border-radius: 8px;
      background: #00ffff;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      z-index: 100; /* above everything */
      box-shadow: 0 0 8px #00ffff88;
    }
  </style>
</head>
<body>

  <!-- ============= EyeWrite UI (copied verbatim) ============= -->
  <!-- We embed the original EyeWrite markup here to preserve its
       functionality. Only relative paths have been updated. -->
  <div id="toolbar">
    <select id="fontSelect">
      <option value="Arial">Arial</option>
      <option value="Times New Roman">Times New Roman</option>
      <option value="Courier New">Courier New</option>
      <option value="Verdana">Verdana</option>
      <option value="Georgia">Georgia</option>
    </select>
    <select id="fontSize">
      <option value="12">12</option>
      <option value="14">14</option>
      <option value="16" selected="">16</option>
      <option value="20">20</option>
      <option value="24">24</option>
    </select>
    <button id="boldBtn"><b>B</b></button>
    <button id="italicBtn"><i>I</i></button>
    <button id="underlineBtn"><u>U</u></button>
    <button id="cursorDefault">Cursor â–£</button>
    <button id="cursorCross">Cross âœ›</button>
    <button id="cursorText">Text âœ</button>
    <button id="kbToggle">âš¡ QuickType</button>
    <button id="hoverToggle" class="active">ğŸŒ€ Hover ON</button>
    <button id="voiceBtn">Voice Modulation</button>
    <div id="voiceControls" class="hidden">
      <label>Voice:</label>
      <select id="voiceSelect"></select>
      <label>Pitch:</label>
      <input type="range" id="pitchSlider" min="0.5" max="2" value="1" step="0.1">
      <label>Rate:</label>
      <input type="range" id="rateSlider" min="0.5" max="2" value="1" step="0.1">
      <button id="previewVoice">Preview</button>
    </div>
    <button id="searchBtn">ğŸ” Search</button>
    <button id="speakBtn">ğŸ”Š Speak</button>
    <div class="saveWrapper">
      <button id="saveBtn">ğŸ’¾ Save</button>
      <div id="saveMenu" class="hidden">
        <button data-format="txt">TXT</button>
        <button data-format="docx">DOCX</button>
        <button data-format="pdf">PDF</button>
      </div>
    </div>
    <button id="instructionsBtn">â” Instructions</button>
  </div>
  <div id="instructionsModal" class="hidden">
    <div class="modalContent" id="instructionsContent">
      <h2>ğŸ‘ï¸ EyeWrite â€” Quick Start Guide</h2>
      <p>
        Welcome to <b>EyeWrite</b> â€” a hands-free writing and communication tool.<br><br>
        <b>Navigation:</b><br>
        â€¢ Hover for 1.5 s to click (Precision Mode)<br>
        â€¢ Hover for 0.7 s or single blink to click (QuickType Mode)<br><br>
        <b>Controls:</b><br>
        â€¢ âš¡ <b>QuickType</b> â€” faster hover speed<br>
        â€¢ ğŸŒ€ <b>Hover ON/OFF</b> â€” toggle dwell clicking<br>
        â€¢ ğŸ”Š <b>Speak</b> â€” text-to-speech output<br>
        â€¢ ğŸ’¾ <b>Save</b> â€” export text (TXT, DOCX, PDF)<br>
        â€¢ ğŸ” <b>Search</b> â€” open half-screen web results<br><br>
        <b>Keyboard:</b><br>
        â€¢ Type by gaze or blink selection<br>
        â€¢ â€œCapsâ€ toggles uppercase, â€œShiftâ€ applies one-time uppercase<br><br>
        <b>Voice Modulation:</b><br>
        â€¢ Adjust pitch, rate, and tone live<br><br>
        <b>Exit:</b><br>
        â€¢ Hover away for 0.7 s or press ESC to close<br><br>
        EyeWrite is built for accessibility, freedom, and creative expression.<br>
        <i>â€œWhere the hands may rest, the eyes and voice continue to speak.â€</i>
      </p>
      <button id="closeInstructions">Close</button>
    </div>
  </div>
  <div id="textContainer">
    <button id="scrollUp" class="scrollBtn">â–² Scroll Up</button>
    <div id="textArea" contenteditable="true"></div>
    <button id="scrollDown" class="scrollBtn">â–¼ Scroll Down</button>
  </div>
  <div id="keyboard">
    <div id="kbHeader">
      <span id="kbMode">ğŸ•Š Precision</span>
    </div>
    <div class="kbRow" id="row1"><button>`</button><button>1</button><button>2</button><button>3</button><button>4</button><button>5</button><button>6</button><button>7</button><button>8</button><button>9</button><button>0</button><button>-</button><button>=</button><button class="wide">âŒ«</button></div>
    <div class="kbRow" id="row2"><button class="wide">Tab</button><button>Q</button><button>W</button><button>E</button><button>R</button><button>T</button><button>Y</button><button>U</button><button>I</button><button>O</button><button>P</button><button>[</button><button>]</button><button>\</button></div>
    <div class="kbRow" id="row3"><button class="wide">Caps</button><button>A</button><button>S</button><button>D</button><button>F</button><button>G</button><button>H</button><button>J</button><button>K</button><button>L</button><button>;</button><button>'</button><button class="wide">â†µ</button></div>
    <div class="kbRow" id="row4"><button class="wide">Shift</button><button>Z</button><button>X</button><button>C</button><button>V</button><button>B</button><button>N</button><button>M</button><button>,</button><button>.</button><button>/</button><button>â†‘</button></div>
    <div class="kbRow" id="row5"><button class="wide">Ctrl</button><button class="extraWide">â£</button><button class="wide">Alt</button><button>â†</button><button>â†“</button><button>â†’</button></div>
  </div>
  <!-- Two cursor rings (as in the original markup) -->
  <div id="cursorRing" class="hidden"></div>
  <div id="cursorRing" class="hidden"></div>

  <!-- ============= SnazyCam Container ============= -->
  <!-- The webcam and overlay will live here. Visibility is toggled by driver.js. -->
  <div id="snazycam-container">
    <video id="video" autoplay muted playsinline></video>
    <canvas id="overlay"></canvas>
  </div>

  <!-- Toggle button for SnazyCam Controls; inserted here so it appears above EyeWrite -->
  <button id="snazycam-toggle-btn">SnazyCam Controls</button>

  <!-- ============= Script Imports ============= -->
  <!-- TensorFlow and BlazeFace dependencies for SnazyCam -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/blazeface"></script>

  <!-- SnazyCam logic (nose tracking) -->
  <script src="snazycam/nose.js"></script>

  <!-- EyeWrite logic file (unmodified) -->
  <script src="eyewrite/app.js"></script>

  <!-- KnowsNav driver: integrates SnazyCam with EyeWrite -->
  <script src="driver.js"></script>
</body>
</html>